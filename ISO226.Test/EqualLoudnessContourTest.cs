using System;
using System.Collections.Generic;
using System.Linq;
using Xunit;

namespace NokitaKaze.ISO226.Test
{
    public class EqualLoudnessContourTest
    {
        public static IEnumerable<object[]> ConvertDbToPhonTestData()
        {
            var referenceTable = new List<double[]>()
            {
                // ISO 226 Reference table #1
                new[] {20d, 89.6d, 20d, 0.5d},
                new[] {25d, 82.7d, 20d, 0.5d},
                new[] {31.5d, 76d, 20d, 0.5d},
                new[] {40d, 69.6d, 20d, 0.5d},
                new[] {50d, 64d, 20d, 0.5d},
                new[] {63d, 58.6d, 20d, 0.5d},
                new[] {80d, 53.2d, 20d, 0.5d},
                new[] {100d, 48.4d, 20d, 0.5d},
                new[] {125d, 43.9d, 20d, 0.5d},
                new[] {160d, 39.4d, 20d, 0.5d},
                new[] {200d, 35.5d, 20d, 0.5d},
                new[] {250d, 32d, 20d, 0.5d},
                new[] {315d, 28.7d, 20d, 0.5d},
                new[] {400d, 25.7d, 20d, 0.5d},
                new[] {500d, 23.4d, 20d, 0.5d},
                new[] {630d, 21.5d, 20d, 1d},
                new[] {800d, 20.1d, 20d, 0.5d},
                new[] {1000d, 20d, 20d, 0.5d},
                new[] {1250d, 21.5d, 20d, 0.5d},
                new[] {1600d, 21.4d, 20d, 0.5d},
                new[] {2000d, 18.2d, 20d, 0.5d},
                new[] {2500d, 15.4d, 20d, 0.5d},
                new[] {3150d, 14.3d, 20d, 0.5d},
                new[] {4000d, 15.1d, 20d, 0.5d},
                new[] {5000d, 18.6d, 20d, 0.5d},
                new[] {6300d, 25d, 20d, 0.5d},
                new[] {8000d, 31.5d, 20d, 0.5d},
                new[] {10000d, 34.4d, 20d, 0.5d},
                new[] {12500d, 33d, 20d, 0.5d},
                new[] {20d, 94.8d, 30d, 0.5d},
                new[] {25d, 88.5d, 30d, 0.5d},
                new[] {31.5d, 82.4d, 30d, 0.5d},
                new[] {40d, 76.5d, 30d, 0.5d},
                new[] {50d, 71.3d, 30d, 0.5d},
                new[] {63d, 66.2d, 30d, 0.5d},
                new[] {80d, 61.2d, 30d, 0.5d},
                new[] {100d, 56.8d, 30d, 0.5d},
                new[] {125d, 52.5d, 30d, 0.5d},
                new[] {160d, 48.4d, 30d, 0.5d},
                new[] {200d, 44.8d, 30d, 0.5d},
                new[] {250d, 41.5d, 30d, 0.5d},
                new[] {315d, 38.4d, 30d, 0.5d},
                new[] {400d, 35.5d, 30d, 0.5d},
                new[] {500d, 33.4d, 30d, 0.5d},
                new[] {630d, 31.5d, 30d, 1d},
                new[] {800d, 30.1d, 30d, 0.5d},
                new[] {1000d, 30d, 30d, 0.5d},
                new[] {1250d, 31.6d, 30d, 0.5d},
                new[] {1600d, 32d, 30d, 0.5d},
                new[] {2000d, 28.8d, 30d, 0.5d},
                new[] {2500d, 26d, 30d, 0.5d},
                new[] {3150d, 25d, 30d, 0.5d},
                new[] {4000d, 26d, 30d, 0.5d},
                new[] {5000d, 29.4d, 30d, 0.5d},
                new[] {6300d, 35.5d, 30d, 0.5d},
                new[] {8000d, 41.7d, 30d, 0.5d},
                new[] {10000d, 44.6d, 30d, 0.5d},
                new[] {12500d, 42.5d, 30d, 0.5d},
                new[] {20d, 99.9d, 40d, 0.5d},
                new[] {25d, 93.9d, 40d, 0.5d},
                new[] {31.5d, 88.2d, 40d, 0.5d},
                new[] {40d, 82.6d, 40d, 0.5d},
                new[] {50d, 77.8d, 40d, 0.5d},
                new[] {63d, 73.1d, 40d, 0.5d},
                new[] {80d, 68.5d, 40d, 0.5d},
                new[] {100d, 64.4d, 40d, 0.5d},
                new[] {125d, 60.6d, 40d, 0.5d},
                new[] {160d, 56.7d, 40d, 0.5d},
                new[] {200d, 53.4d, 40d, 0.5d},
                new[] {250d, 50.4d, 40d, 0.5d},
                new[] {315d, 47.6d, 40d, 0.5d},
                new[] {400d, 45d, 40d, 0.5d},
                new[] {500d, 43.1d, 40d, 0.5d},
                new[] {630d, 41.3d, 40d, 0.5d},
                new[] {800d, 40.1d, 40d, 0.5d},
                new[] {1000d, 40d, 40d, 0.5d},
                new[] {1250d, 41.8d, 40d, 0.5d},
                new[] {1600d, 42.5d, 40d, 0.5d},
                new[] {2000d, 39.2d, 40d, 0.5d},
                new[] {2500d, 36.5d, 40d, 0.5d},
                new[] {3150d, 35.6d, 40d, 0.5d},
                new[] {4000d, 36.6d, 40d, 0.5d},
                new[] {5000d, 40d, 40d, 0.5d},
                new[] {6300d, 45.8d, 40d, 0.5d},
                new[] {8000d, 51.8d, 40d, 0.5d},
                new[] {10000d, 54.3d, 40d, 0.5d},
                new[] {12500d, 51.5d, 40d, 0.5d},
                new[] {20d, 104.7d, 50d, 0.5d},
                new[] {25d, 99.1d, 50d, 0.5d},
                new[] {31.5d, 93.7d, 50d, 0.5d},
                new[] {40d, 88.5d, 50d, 0.5d},
                new[] {50d, 84d, 50d, 0.5d},
                new[] {63d, 79.6d, 50d, 0.5d},
                new[] {80d, 75.4d, 50d, 0.5d},
                new[] {100d, 71.6d, 50d, 0.5d},
                new[] {125d, 68.2d, 50d, 0.5d},
                new[] {160d, 64.7d, 50d, 0.5d},
                new[] {200d, 61.7d, 50d, 0.5d},
                new[] {250d, 59d, 50d, 0.5d},
                new[] {315d, 56.5d, 50d, 0.5d},
                new[] {400d, 54.3d, 50d, 0.5d},
                new[] {500d, 52.6d, 50d, 0.5d},
                new[] {630d, 51.1d, 50d, 0.5d},
                new[] {800d, 50d, 50d, 0.5d},
                new[] {1000d, 50d, 50d, 0.5d},
                new[] {1250d, 52d, 50d, 0.5d},
                new[] {1600d, 52.9d, 50d, 0.5d},
                new[] {2000d, 49.6d, 50d, 0.5d},
                new[] {2500d, 46.9d, 50d, 0.5d},
                new[] {3150d, 46.1d, 50d, 0.5d},
                new[] {4000d, 47.1d, 50d, 0.5d},
                new[] {5000d, 50.5d, 50d, 0.5d},
                new[] {6300d, 56.1d, 50d, 0.5d},
                new[] {8000d, 61.8d, 50d, 0.5d},
                new[] {10000d, 63.8d, 50d, 0.5d},
                new[] {12500d, 60.1d, 50d, 0.5d},
                new[] {20d, 109.5d, 60d, 0.5d},
                new[] {25d, 104.2d, 60d, 0.5d},
                new[] {31.5d, 99.1d, 60d, 0.5d},
                new[] {40d, 94.2d, 60d, 0.5d},
                new[] {50d, 90d, 60d, 0.5d},
                new[] {63d, 85.9d, 60d, 0.5d},
                new[] {80d, 82.1d, 60d, 0.5d},
                new[] {100d, 78.7d, 60d, 0.5d},
                new[] {125d, 75.6d, 60d, 0.5d},
                new[] {160d, 72.5d, 60d, 0.5d},
                new[] {200d, 69.9d, 60d, 0.5d},
                new[] {250d, 67.5d, 60d, 0.5d},
                new[] {315d, 65.4d, 60d, 0.5d},
                new[] {400d, 63.5d, 60d, 0.5d},
                new[] {500d, 62.1d, 60d, 0.5d},
                new[] {630d, 60.8d, 60d, 0.5d},
                new[] {800d, 59.9d, 60d, 0.5d},
                new[] {1000d, 60d, 60d, 0.5d},
                new[] {1250d, 62.2d, 60d, 0.5d},
                new[] {1600d, 63.2d, 60d, 0.5d},
                new[] {2000d, 60d, 60d, 0.5d},
                new[] {2500d, 57.3d, 60d, 0.5d},
                new[] {3150d, 56.4d, 60d, 0.5d},
                new[] {4000d, 57.6d, 60d, 0.5d},
                new[] {5000d, 60.9d, 60d, 0.5d},
                new[] {6300d, 66.4d, 60d, 0.5d},
                new[] {8000d, 71.7d, 60d, 0.5d},
                new[] {10000d, 73.2d, 60d, 0.5d},
                new[] {12500d, 68.6d, 60d, 0.5d},
                new[] {20d, 114.3d, 70d, 0.5d},
                new[] {25d, 109.2d, 70d, 0.5d},
                new[] {31.5d, 104.4d, 70d, 0.5d},
                new[] {40d, 99.8d, 70d, 0.5d},
                new[] {50d, 95.9d, 70d, 0.5d},
                new[] {63d, 92.2d, 70d, 0.5d},
                new[] {80d, 88.6d, 70d, 0.5d},
                new[] {100d, 85.6d, 70d, 0.5d},
                new[] {125d, 82.9d, 70d, 0.5d},
                new[] {160d, 80.2d, 70d, 0.5d},
                new[] {200d, 77.9d, 70d, 0.5d},
                new[] {250d, 75.9d, 70d, 0.5d},
                new[] {315d, 74.2d, 70d, 0.5d},
                new[] {400d, 72.6d, 70d, 0.5d},
                new[] {500d, 71.5d, 70d, 0.5d},
                new[] {630d, 70.5d, 70d, 0.5d},
                new[] {800d, 69.8d, 70d, 0.5d},
                new[] {1000d, 70d, 70d, 0.5d},
                new[] {1250d, 72.3d, 70d, 0.5d},
                new[] {1600d, 73.5d, 70d, 0.5d},
                new[] {2000d, 70.3d, 70d, 0.5d},
                new[] {2500d, 67.6d, 70d, 0.5d},
                new[] {3150d, 66.8d, 70d, 0.5d},
                new[] {4000d, 68d, 70d, 0.5d},
                new[] {5000d, 71.3d, 70d, 0.5d},
                new[] {6300d, 76.6d, 70d, 0.5d},
                new[] {8000d, 81.5d, 70d, 0.5d},
                new[] {10000d, 82.5d, 70d, 0.5d},
                new[] {12500d, 77d, 70d, 0.5d},
                new[] {20d, 119d, 80d, 0.5d},
                new[] {25d, 114.2d, 80d, 0.5d},
                new[] {31.5d, 109.6d, 80d, 0.5d},
                new[] {40d, 105.3d, 80d, 0.5d},
                new[] {50d, 101.7d, 80d, 0.5d},
                new[] {63d, 98.4d, 80d, 0.5d},
                new[] {80d, 95.2d, 80d, 0.5d},
                new[] {100d, 92.5d, 80d, 0.5d},
                new[] {125d, 90.1d, 80d, 0.5d},
                new[] {160d, 87.8d, 80d, 0.5d},
                new[] {200d, 85.9d, 80d, 0.5d},
                new[] {250d, 84.3d, 80d, 0.5d},
                new[] {315d, 82.9d, 80d, 0.5d},
                new[] {400d, 81.7d, 80d, 0.5d},
                new[] {500d, 80.9d, 80d, 0.5d},
                new[] {630d, 80.2d, 80d, 0.5d},
                new[] {800d, 79.7d, 80d, 0.5d},
                new[] {1000d, 80d, 80d, 0.5d},
                new[] {1250d, 82.5d, 80d, 0.5d},
                new[] {1600d, 83.7d, 80d, 0.5d},
                new[] {2000d, 80.6d, 80d, 0.5d},
                new[] {2500d, 77.9d, 80d, 0.5d},
                new[] {3150d, 77.1d, 80d, 0.5d},
                new[] {4000d, 78.3d, 80d, 0.5d},
                new[] {5000d, 81.6d, 80d, 0.5d},
                new[] {6300d, 86.8d, 80d, 0.5d},
                new[] {8000d, 91.4d, 80d, 0.5d},
                new[] {10000d, 91.7d, 80d, 0.5d},
                new[] {12500d, 85.4d, 80d, 0.5d},
                new[] {20d, 123.7d, 90d, 0.5d},
                new[] {25d, 119.2d, 90d, 0.5d},
                new[] {31.5d, 114.9d, 90d, 0.5d},
                new[] {40d, 110.9d, 90d, 0.5d},
                new[] {50d, 107.5d, 90d, 0.5d},
                new[] {63d, 104.5d, 90d, 0.5d},
                new[] {80d, 101.7d, 90d, 0.5d},
                new[] {100d, 99.3d, 90d, 0.5d},
                new[] {125d, 97.3d, 90d, 0.5d},
                new[] {160d, 95.4d, 90d, 0.5d},
                new[] {200d, 93.9d, 90d, 0.5d},
                new[] {250d, 92.6d, 90d, 0.5d},
                new[] {315d, 91.6d, 90d, 0.5d},
                new[] {400d, 90.8d, 90d, 0.5d},
                new[] {500d, 90.2d, 90d, 0.5d},
                new[] {630d, 89.8d, 90d, 0.5d},
                new[] {800d, 89.6d, 90d, 0.5d},
                new[] {1000d, 90d, 90d, 0.5d},
                new[] {1250d, 92.6d, 90d, 0.5d},
                new[] {1600d, 94d, 90d, 0.5d},
                new[] {2000d, 90.9d, 90d, 0.5d},
                new[] {2500d, 88.2d, 90d, 0.5d},
                new[] {3150d, 87.4d, 90d, 0.5d},
                new[] {4000d, 88.7d, 90d, 0.5d},
                new[] {20d, 128.4d, 100d, 0.5d},
                new[] {25d, 124.2d, 100d, 0.5d},
                new[] {31.5d, 120.1d, 100d, 0.5d},
                new[] {40d, 116.4d, 100d, 0.5d},
                new[] {50d, 113.4d, 100d, 0.5d},
                new[] {63d, 110.6d, 100d, 0.5d},
                new[] {80d, 108.2d, 100d, 0.5d},
                new[] {100d, 106.2d, 100d, 0.5d},
                new[] {125d, 104.5d, 100d, 0.5d},
                new[] {160d, 103d, 100d, 0.5d},
                new[] {200d, 101.8d, 100d, 0.5d},
                new[] {250d, 101d, 100d, 0.5d},
                new[] {315d, 100.3d, 100d, 0.5d},
                new[] {400d, 99.8d, 100d, 0.5d},
                new[] {500d, 99.6d, 100d, 0.5d},
                new[] {630d, 99.5d, 100d, 0.5d},
                new[] {800d, 99.4d, 100d, 0.5d},
                new[] {1000d, 100d, 100d, 0.5d},

                // ISO 226 reference table #2
                new[] {2500d, 0d, 6.1d, 0.5d},
                new[] {3150d, 0d, 7.4d, 0.5d},
                new[] {4000d, 0d, 6.8d, 0.5d},
                new[] {400d, 10d, 5.5d, 0.5d},
                new[] {500d, 10d, 7.3d, 0.5d},
                new[] {630d, 10d, 8.9d, 2d},
                new[] {800d, 10d, 10d, 0.5d},
                new[] {1000d, 10d, 10d, 0.5d},
                new[] {1250d, 10d, 8.8d, 0.5d},
                new[] {1600d, 10d, 9.6d, 0.5d},
                new[] {2000d, 10d, 12.5d, 0.5d},
                new[] {2500d, 10d, 15.1d, 0.5d},
                new[] {3150d, 10d, 16.2d, 0.5d},
                new[] {4000d, 10d, 15.4d, 0.5d},
                new[] {5000d, 10d, 12.3d, 0.5d},
                new[] {6300d, 10d, 6d, 0.5d},
                new[] {200d, 20d, 6.2d, 0.5d},
                new[] {250d, 20d, 8.9d, 0.5d},
                new[] {315d, 20d, 11.8d, 0.5d},
                new[] {400d, 20d, 14.5d, 0.5d},
                new[] {500d, 20d, 16.7d, 0.5d},
                new[] {630d, 20d, 18.6d, 1d},
                new[] {800d, 20d, 19.9d, 0.5d},
                new[] {1000d, 20d, 20d, 0.5d},
                new[] {1250d, 20d, 18.6d, 0.5d},
                new[] {1600d, 20d, 18.7d, 0.5d},
                new[] {2000d, 20d, 21.8d, 0.5d},
                new[] {2500d, 20d, 24.3d, 0.5d},
                new[] {3150d, 20d, 25.3d, 0.5d},
                new[] {4000d, 20d, 24.5d, 0.5d},
                new[] {5000d, 20d, 21.3d, 0.5d},
                new[] {6300d, 20d, 15.3d, 0.5d},
                new[] {8000d, 20d, 9.1d, 0.5d},
                new[] {10000d, 20d, 7.1d, 0.5d},
                new[] {12500d, 20d, 8.1d, 0.5d},
                new[] {200d, 30d, 14.6d, 0.5d},
                new[] {250d, 30d, 18d, 0.5d},
                new[] {315d, 30d, 21.3d, 0.5d},
                new[] {400d, 30d, 24.4d, 0.5d},
                new[] {500d, 30d, 26.6d, 0.5d},
                new[] {630d, 30d, 28.5d, 1d},
                new[] {800d, 30d, 29.9d, 0.5d},
                new[] {1000d, 30d, 30d, 0.5d},
                new[] {1250d, 30d, 28.4d, 0.5d},
                new[] {1600d, 30d, 28.1d, 0.5d},
                new[] {2000d, 30d, 31.2d, 0.5d},
                new[] {2500d, 30d, 33.8d, 0.5d},
                new[] {3150d, 30d, 34.7d, 0.5d},
                new[] {4000d, 30d, 33.8d, 0.5d},
                new[] {5000d, 30d, 30.6d, 0.5d},
                new[] {6300d, 30d, 24.8d, 0.5d},
                new[] {8000d, 30d, 18.6d, 0.5d},
                new[] {10000d, 30d, 15.9d, 0.5d},
                new[] {12500d, 30d, 17d, 0.5d},
                new[] {80d, 40d, 7.5d, 0.5d},
                new[] {100d, 40d, 11.6d, 0.5d},
                new[] {125d, 40d, 16d, 0.5d},
                new[] {160d, 40d, 20.7d, 0.5d},
                new[] {200d, 40d, 24.8d, 0.5d},
                new[] {250d, 40d, 28.4d, 0.5d},
                new[] {315d, 40d, 31.8d, 0.5d},
                new[] {400d, 40d, 34.7d, 0.5d},
                new[] {500d, 40d, 36.9d, 0.5d},
                new[] {630d, 40d, 38.7d, 0.5d},
                new[] {800d, 40d, 40d, 0.5d},
                new[] {1000d, 40d, 40d, 0.5d},
                new[] {1250d, 40d, 38.2d, 0.5d},
                new[] {1600d, 40d, 37.6d, 0.5d},
                new[] {2000d, 40d, 40.8d, 0.5d},
                new[] {2500d, 40d, 43.4d, 0.5d},
                new[] {3150d, 40d, 44.2d, 0.5d},
                new[] {4000d, 40d, 43.2d, 0.5d},
                new[] {5000d, 40d, 40d, 0.5d},
                new[] {6300d, 40d, 34.4d, 0.5d},
                new[] {8000d, 40d, 28.3d, 0.5d},
                new[] {10000d, 40d, 25.5d, 0.5d},
                new[] {12500d, 40d, 27.3d, 0.5d},
                new[] {50d, 50d, 6d, 0.5d},
                new[] {63d, 50d, 10.9d, 0.5d},
                new[] {80d, 50d, 16.5d, 0.5d},
                new[] {100d, 50d, 21.9d, 0.5d},
                new[] {125d, 50d, 26.9d, 0.5d},
                new[] {160d, 50d, 31.9d, 0.5d},
                new[] {200d, 50d, 36d, 0.5d},
                new[] {250d, 50d, 39.6d, 0.5d},
                new[] {315d, 50d, 42.7d, 0.5d},
                new[] {400d, 50d, 45.4d, 0.5d},
                new[] {500d, 50d, 47.3d, 0.5d},
                new[] {630d, 50d, 48.9d, 0.5d},
                new[] {800d, 50d, 50d, 0.5d},
                new[] {1000d, 50d, 50d, 0.5d},
                new[] {1250d, 50d, 48.1d, 0.5d},
                new[] {1600d, 50d, 47.3d, 0.5d},
                new[] {2000d, 50d, 50.4d, 0.5d},
                new[] {2500d, 50d, 53d, 0.5d},
                new[] {3150d, 50d, 53.8d, 0.5d},
                new[] {4000d, 50d, 52.8d, 0.5d},
                new[] {5000d, 50d, 49.6d, 0.5d},
                new[] {6300d, 50d, 44.1d, 0.5d},
                new[] {8000d, 50d, 38.2d, 0.5d},
                new[] {10000d, 50d, 35.6d, 0.5d},
                new[] {12500d, 50d, 38.3d, 0.5d},
                new[] {40d, 60d, 8.9d, 0.5d},
                new[] {50d, 60d, 15.2d, 0.5d},
                new[] {63d, 60d, 21.8d, 0.5d},
                new[] {80d, 60d, 28.4d, 0.5d},
                new[] {100d, 60d, 34.2d, 0.5d},
                new[] {125d, 60d, 39.3d, 0.5d},
                new[] {160d, 60d, 44.1d, 0.5d},
                new[] {200d, 60d, 47.9d, 0.5d},
                new[] {250d, 60d, 51.2d, 0.5d},
                new[] {315d, 60d, 53.9d, 0.5d},
                new[] {400d, 60d, 56.3d, 0.5d},
                new[] {500d, 60d, 57.9d, 0.5d},
                new[] {630d, 60d, 59.2d, 0.5d},
                new[] {800d, 60d, 60.1d, 0.5d},
                new[] {1000d, 60d, 60d, 0.5d},
                new[] {1250d, 60d, 57.9d, 0.5d},
                new[] {1600d, 60d, 56.9d, 0.5d},
                new[] {2000d, 60d, 60.1d, 0.5d},
                new[] {2500d, 60d, 62.7d, 0.5d},
                new[] {3150d, 60d, 63.5d, 0.5d},
                new[] {4000d, 60d, 62.4d, 0.5d},
                new[] {5000d, 60d, 59.2d, 0.5d},
                new[] {6300d, 60d, 53.8d, 0.5d},
                new[] {8000d, 60d, 48.3d, 0.5d},
                new[] {10000d, 60d, 46d, 0.5d},
                new[] {12500d, 60d, 49.9d, 0.5d},
                new[] {31.5d, 70d, 12.1d, 0.5d},
                new[] {40d, 70d, 20.6d, 0.5d},
                new[] {50d, 70d, 28.2d, 0.5d},
                new[] {63d, 70d, 35.5d, 0.5d},
                new[] {80d, 70d, 42.2d, 0.5d},
                new[] {100d, 70d, 47.8d, 0.5d},
                new[] {125d, 70d, 52.5d, 0.5d},
                new[] {160d, 70d, 56.8d, 0.5d},
                new[] {200d, 70d, 60.2d, 0.5d},
                new[] {250d, 70d, 63d, 0.5d},
                new[] {315d, 70d, 65.3d, 0.5d},
                new[] {400d, 70d, 67.2d, 0.5d},
                new[] {500d, 70d, 68.5d, 0.5d},
                new[] {630d, 70d, 69.5d, 0.5d},
                new[] {800d, 70d, 70.3d, 0.5d},
                new[] {1000d, 70d, 70d, 0.5d},
                new[] {1250d, 70d, 67.8d, 0.5d},
                new[] {1600d, 70d, 66.7d, 0.5d},
                new[] {2000d, 70d, 69.8d, 0.5d},
                new[] {2500d, 70d, 72.4d, 0.5d},
                new[] {3150d, 70d, 73.2d, 0.5d},
                new[] {4000d, 70d, 72d, 0.5d},
                new[] {5000d, 70d, 68.8d, 0.5d},
                new[] {6300d, 70d, 63.6d, 0.5d},
                new[] {8000d, 70d, 58.4d, 0.5d},
                new[] {10000d, 70d, 56.7d, 0.5d},
                new[] {12500d, 70d, 61.7d, 0.5d},
                new[] {20d, 80d, 4.4d, 0.5d},
                new[] {25d, 80d, 15.9d, 0.5d},
                new[] {31.5d, 80d, 26.2d, 0.5d},
                new[] {40d, 80d, 35.7d, 0.5d},
                new[] {50d, 80d, 43.6d, 0.5d},
                new[] {63d, 80d, 50.7d, 0.5d},
                new[] {80d, 80d, 57d, 0.5d},
                new[] {100d, 80d, 62d, 0.5d},
                new[] {125d, 80d, 66.1d, 0.5d},
                new[] {160d, 80d, 69.8d, 0.5d},
                new[] {200d, 80d, 72.6d, 0.5d},
                new[] {250d, 80d, 74.9d, 0.5d},
                new[] {315d, 80d, 76.7d, 0.5d},
                new[] {400d, 80d, 78.2d, 0.5d},
                new[] {500d, 80d, 79.1d, 0.5d},
                new[] {630d, 80d, 79.9d, 0.5d},
                new[] {800d, 80d, 80.4d, 0.5d},
                new[] {1000d, 80d, 80d, 0.5d},
                new[] {1250d, 80d, 77.6d, 0.5d},
                new[] {1600d, 80d, 76.4d, 0.5d},
                new[] {2000d, 80d, 79.5d, 0.5d},
                new[] {2500d, 80d, 82.1d, 0.5d},
                new[] {3150d, 80d, 82.9d, 0.5d},
                new[] {4000d, 80d, 81.7d, 0.5d},
                new[] {5000d, 80d, 78.5d, 0.5d},
                new[] {6300d, 80d, 73.4d, 0.5d},
                new[] {8000d, 80d, 68.5d, 0.5d},
                new[] {10000d, 80d, 67.4d, 0.5d},
                new[] {12500d, 80d, 73.6d, 0.5d},
                new[] {20d, 90d, 20.8d, 0.5d},
                new[] {25d, 90d, 32.7d, 0.5d},
                new[] {31.5d, 90d, 43.3d, 0.5d},
                new[] {40d, 90d, 52.7d, 0.5d},
                new[] {50d, 90d, 60.1d, 0.5d},
                new[] {63d, 90d, 66.5d, 0.5d},
                new[] {80d, 90d, 72.1d, 0.5d},
                new[] {100d, 90d, 76.4d, 0.5d},
                new[] {125d, 90d, 79.9d, 0.5d},
                new[] {160d, 90d, 82.9d, 0.5d},
                new[] {200d, 90d, 85.2d, 0.5d},
                new[] {250d, 90d, 86.9d, 0.5d},
                new[] {315d, 90d, 88.2d, 0.5d},
                new[] {400d, 90d, 89.2d, 0.5d},
                new[] {500d, 90d, 89.8d, 0.5d},
                new[] {630d, 90d, 90.2d, 0.5d},
                new[] {800d, 90d, 90.5d, 0.5d},
                new[] {1000d, 90d, 90d, 0.5d},
                new[] {1250d, 90d, 87.4d, 0.5d},
                new[] {1600d, 90d, 86.1d, 0.5d},
                new[] {2000d, 90d, 89.2d, 0.5d},
                new[] {8000d, 90d, 78.6d, 0.5d},
                new[] {10000d, 90d, 78.2d, 0.5d},
                new[] {20d, 100d, 40.3d, 0.5d},
                new[] {25d, 100d, 51.7d, 0.5d},
                new[] {31.5d, 100d, 61.8d, 0.5d},
                new[] {40d, 100d, 70.4d, 0.5d},
                new[] {50d, 100d, 77.1d, 0.5d},
                new[] {63d, 100d, 82.7d, 0.5d},
                new[] {80d, 100d, 87.5d, 0.5d},
                new[] {100d, 100d, 91d, 0.5d},
                new[] {125d, 100d, 93.8d, 0.5d},
                new[] {160d, 100d, 96.1d, 0.5d},
                new[] {200d, 100d, 97.7d, 0.5d},
                new[] {250d, 100d, 98.9d, 0.5d},
                new[] {315d, 100d, 99.7d, 0.5d},
                new[] {1000d, 100d, 100d, 0.5d},
                new[] {20d, 110d, 61.1d, 0.5d},
                new[] {25d, 110d, 71.6d, 0.5d},
                new[] {31.5d, 110d, 80.7d, 0.5d},
                new[] {40d, 110d, 88.5d, 0.5d},
                new[] {50d, 110d, 94.3d, 0.5d},
                new[] {63d, 110d, 99d, 0.5d},
                new[] {20d, 120d, 82.2d, 0.5d},
                new[] {25d, 120d, 91.7d, 0.5d},
                new[] {31.5d, 120d, 99.8d, 0.5d},
            };

            var resultTable = new List<object[]>();
            var used = new List<Tuple<double, double, double>>();
            foreach (var item in referenceTable)
            {
                var u = used.Any(usedT =>
                    (usedT.Item1 == item[0]) && (usedT.Item2 == item[1]) && (usedT.Item3 == item[2]));

                if (!u)
                {
                    var t = new object[] {item[0], item[1], item[2], item[3],};

                    resultTable.Add(t);
                    used.Add(new Tuple<double, double, double>(item[0], item[1], item[2]));
                }
            }

            return resultTable;
        }

        /*

        [Fact]
        public void Draw()
        {
            var iso_f = EqualLoudnessContour.iso_f;
            var tsvTable1 = new List<string>() {"F\ta_f\tL_u\tT_f"};
            // ReSharper disable once LoopCanBeConvertedToQuery
            for (int i = 0; i < iso_f.Count; i++)
            {
                var f = iso_f[i];

                tsvTable1.Add(string.Format(
                    "{0}\t{1}\t{2}\t{3}",
                    f.ToString("F3").Replace('.', ','),
                    EqualLoudnessContour.iso_a_f[i].ToString("F3").Replace('.', ','),
                    EqualLoudnessContour.iso_L_u[i].ToString("F3").Replace('.', ','),
                    EqualLoudnessContour.iso_T_f[i].ToString("F3").Replace('.', ',')
                ));
            }

            System.IO.File.WriteAllLines(@"h:\f.tsv", tsvTable1);

            //
            var titleS = iso_f.Aggregate("Фон",
                (current, hz) => current + ("\t" + hz.ToString("F1").Replace('.', ',')));

            var tsvTable2 = new List<string>() {titleS};
            for (double phon = 10; phon <= 100; phon += 10)
            {
                var s = "Фон-" + phon.ToString("F0");
                foreach (var hz in iso_f)
                {
                    var db = EqualLoudnessContour.ConvertPhonToDb(phon, hz);

                    s += "\t" + db.ToString("F1").Replace('.', ',');
                }

                tsvTable2.Add(s);
            }

            System.IO.File.WriteAllLines(@"h:\hz.tsv", tsvTable2);
        }

        // */

        [Theory]
        [MemberData(nameof(ConvertDbToPhonTestData))]
        public void ConvertDbToPhonTest(double hz, double referenceDb, double referencePhon, double diff)
        {
            var actualPhon = EqualLoudnessContour.ConvertDbToPhon(referenceDb, hz);
            Assert.InRange(Math.Abs(actualPhon - referencePhon), 0, diff);

            var actualDb = EqualLoudnessContour.ConvertPhonToDb(referencePhon, hz);
            Assert.InRange(Math.Abs(actualDb - referenceDb), 0, diff);
        }
    }
}